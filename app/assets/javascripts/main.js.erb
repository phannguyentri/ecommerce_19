$(document).ready(function() {

  $('.change-status').on('click', function(e) {
    e.preventDefault();
    id = $(this).attr('id');
    status = $(this).attr('data-status');
    $.ajax({
      type: 'put',
      url : '/admin/orderitems/'+id,
      dataType: 'json',
      context: this,
      data: {
        orderitem: {
          status: status
        }
      },
      success: function(response) {
        $(this).attr('data-status', check_status(status, 'false', 'true'));
        $(this).parent().parent().find('.status')
          .removeClass(check_status(status, 'label-danger', 'label-success'))
          .addClass(check_status(status, 'label-success', 'label-danger'))
          .text(check_status(status, '<%= I18n.t("view.placed") %>',
            '<%= I18n.t("view.cancel") %>'));
      },
      error: function(error_message) {
        alert(error_message.responseText);
      }
    });
  });
});

function check_status(status, case1, case2){
  return status == 'true' ? case1 : case2;
}
